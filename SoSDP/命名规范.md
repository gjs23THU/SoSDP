# SoS_env.py 命名规范统一说明

## 统一后的命名规范

### 1. 全局常量（大写+下划线）

| 常量名 | 值 | 含义 | 原命名 |
|--------|---|------|-------|
| `NUM_TASKS` | 5 | 任务数量 | `TaskNum` |
| `NUM_SYSTEMS` | 50 | 候选子系统数量 | `Size` |
| `DISTCON` | 2.0 | 距离约束阈值 | - |
| `CONST1` | 0.96 | 衰减系数 | - |

### 2. 函数/类参数（小写+下划线）

#### SoSDataset 参数

| 参数名 | 默认值 | 含义 | 原命名 |
|--------|-------|------|-------|
| `num_systems` | 50 | 候选子系统数量 | `size` |
| `num_tasks` | 5 | 任务数量 | `Num` |
| `num_samples` | 10000 | 生成的问题实例数量 | - |
| `seed` | None | 随机种子 | - |

#### SoSEnv 参数

| 参数名 | 默认值 | 含义 | 原命名 |
|--------|-------|------|-------|
| `num_systems` | 50 | 候选子系统数量 | `num_nodes` |
| `num_samples` | 1000 | 问题实例数量 | - |
| `num_tasks` | NUM_TASKS | 任务数量 | `capnum`/`task_num` |
| `seed` | None | 随机种子 | - |
| `distcon` | DISTCON | 距离约束阈值 | - |
| `const1` | CONST1 | 衰减系数 | - |
| `max_steps` | None | 每回合最大步数 | - |

### 3. 类内部变量（小写+下划线）

#### SoSEnv 实例变量

| 变量名 | 含义 | 原命名 |
|--------|------|-------|
| `self.num_tasks` | 任务数量 | `self.TaskNum` |
| `self.num_nodes` | 节点总数 (= num_systems × NUM_TASKS) | - |
| `self.distcon` | 距离约束阈值 | - |
| `self.const1` | 衰减系数 | - |

---

## 核心概念说明

### 1. 任务数量（num_tasks）
- **含义**：SoS 问题中的任务类型数量
- **默认值**：5
- **作用**：决定每个子系统对应多少个任务节点

### 2. 子系统数量（num_systems）
- **含义**：候选子系统的数量
- **默认值**：50
- **作用**：决定有多少个独立的子系统可供选择

### 3. 节点总数（num_nodes）
- **计算方式**：`num_systems × NUM_TASKS`
- **含义**：所有可选节点的总数（每个子系统×每个任务）
- **示例**：50 个子系统 × 5 个任务 = 250 个节点

### 4. 样本数量（num_samples）
- **含义**：数据集中生成的问题实例数量
- **默认值**：训练集 10000，验证/测试集 1000
- **作用**：决定有多少个不同的问题实例用于训练/测试

---

## 数据维度说明

### SoSDataset 内部张量

| 张量名 | 形状 | 含义 |
|--------|------|------|
| `T1~T5` | `(num_samples, 1, 4)` | 每个任务的 4 维能力需求 |
| `dist1~dist5` | `(num_samples, 1, 2)` | 每个任务的 2 维位置参数 |
| `dataset1` | `(num_samples, num_tasks-1, num_systems)` | 基础系统属性（4维） |
| `temp1` | `(num_samples, 1, num_systems)` | 综合属性（第5维） |
| `distsys` | `(num_samples, 2, num_systems)` | 系统位置坐标 |
| `dataset` | `(num_samples, num_tasks+2, num_systems)` | 完整系统特征 (5+2维) |
| `dataset2` | `(num_samples, 13, num_systems×NUM_TASKS)` | 最终特征张量 |

### SoSEnv 观察空间

| 字段 | 形状 | 含义 |
|------|------|------|
| `static` | `(13, num_nodes)` | 静态特征 |
| `dynamic` | `(1, num_nodes)` | 动态特征 |
| `mask` | `(num_nodes,)` | 合法动作掩码 |
| `t` | `(4, num_tasks)` | 每个任务的剩余需求 |
| `step_count` | `int` | 当前步数 |

---

## 命名规范原则

✅ **常量**：全大写+下划线（`NUM_TASKS`）  
✅ **变量/参数**：全小写+下划线（`num_systems`）  
✅ **类名**：大驼峰命名（`SoSDataset`）  
✅ **方法名**：小写+下划线（`_execute_action`）  
✅ **私有方法**：下划线开头（`_initialize_state`）  

---

## 迁移指南

如果你有旧代码使用旧命名，请按以下映射修改：

```python
# 旧代码
env = SoSEnv(num_nodes=50, capnum=5, task_num=5)

# 新代码
env = SoSEnv(num_systems=50, num_tasks=5)
```

```python
# 旧代码
dataset = SoSDataset(size=50, Num=5)

# 新代码
dataset = SoSDataset(num_systems=50, num_tasks=5)
```

---

**统一命名后的优势**：
- 更清晰的语义
- 符合 Python PEP8 规范
- 减少混淆（如 size/num_nodes/capnum 都指同一概念）
- 便于代码维护和协作
